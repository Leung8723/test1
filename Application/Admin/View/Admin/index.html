<include file="Index/header" />
<body>
<div id="wrapper">
  <include file="Index/nav"/>
  <div id="page-wrapper">
    <div class="container-fluid" >
	<!-- DataTables CSS -->
	<link rel="stylesheet" type="text/css" href="Public/css/layui/css/layui.css">
	<link rel="stylesheet" type="text/css" href="Public/js/Datatables/jquery.dataTables.min.css">
	<link rel="stylesheet" type="text/css" href="Public/js/Datatables/buttons.dataTables.min.css">
	<!-- jQuery -->
	<!-- <script type="text/javascript" charset="utf8" src="Public/js/jquery.js"></script> -->
	<script type="text/javascript" charset="utf8" src="Public/js/Datatables/jquery.dataTables.min.js"></script>
	<script type="text/javascript" charset="utf8" src="Public/js/Datatables/dataTables.buttons.min.js"></script>
	<script type="text/javascript" charset="utf8" src="Public/js/Datatables/dataTables.bootstrap.min.js"></script>
	<script type="text/javascript" charset="utf8" src="Public/js/Datatables/buttons.html5.min.js"></script>
	<script type="text/javascript" charset="utf8" src="Public/js/Datatables/jszip.min.js"></script>
	<!-- Page Heading -->
	</br></br></br></br>
        <div class="row">
            <div class="col-lg-12">
                <ol class="breadcrumb">
                    <li>
                        <i class="fa fa-dashboard"></i><a href="/admin.php?c=admin"> 用户管理</a>
                    </li>
                    <li class="active">
                        <i class="fa fa-table"></i> 用户列表
                    </li>
                </ol>
            </div>
        </div>
        <!-- /.row -->
        <div class="layui-form-item">
          <button  id="button-add" type="button" class="layui-btn layui-icon" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">&#xe612 添加新用户</button>
        </div>
	  <form>
		<table id="lens-table" class="cell-border stripe hover compact order-column" >
		  <thead>
		  <tr>
			<th>ID</th>
			<th>姓名</th>
			<th>用户名</th>
			<th>手机号</th>
			<th>内线</th>
			<th>E-mail</th>
			<th>权限组</th>
			<th>最后登录时间</th>
			<th>最后登录设备</th>
			<th>创建人</th>
			<!-- <th>创建时间</th> -->
			<!-- <th>更新时间</th> -->
			<th>状态</th>
			<th>操作</th>
		  </tr>
		  </thead>
			<tbody>
			<volist name="admins" id="vo">
			  <tr>
				<td>{$vo.admin_id}</td>
				<td>{$vo.realname}</td>
				<td>{$vo.username}</td>
				<td><if condition="$vo['mobile'] eq NULL">-<else/>{$vo.mobile}</if></td>
				<td><if condition="$vo['skline'] eq NULL">-<else/>{$vo.skline}</if></td>
				<td><if condition="$vo['email'] eq NULL">-<else/><a href="mailto:{$vo.email}">{$vo.email}</a></if></td>
				<td><if condition="$vo['power'] eq NULL">-<else/>{$vo.power}</if></td>
				<td><if condition="$vo['lastlogintime'] eq NULL">-<else/>{$vo.lastlogintime|date="Y-m-d H:i:s",###}</if></td>
				<td><if condition="$vo['lastloginip'] eq NULL">-<else/>{$vo.lastloginip}</if></td>
				<td>{$vo.create_user}</td>
				<!-- <td>{$vo.create_time|date="Y-m-d H:i",###}</td> -->
				<!-- <td><if condition="$vo['update_time'] eq NULL">-<else/>{$vo.update_time|date="Y-m-d H:i",###}</if></td> -->
				<td><if condition="$vo['status'] eq 1">激活<else/>锁定</if></td>
				<td></td>
			  </tr>
			</volist>
			</tbody>
		</table>
	  </form>
    </div>
   </div>
</div>
<script>
var SCOPE = {
	'add_url' : '/admin.php?c=admin&a=add',
	'edit_url' : '/admin.php?c=admin&a=personal',
}
//初始化DataTables
$(document).ready( function () {
	$('#lens-table').DataTable({
	    dom: 'Bfrtip',
		buttons: [{
			extend: 'excelHtml5',
			text: '导出',
			title: '用户列表',
			exportOptions: {
				modifier: {
					page: 'current'
				}
			}
		}],
		"order": [[ 0, "asc" ]],
		"aoColumnDefs":[//设置列的属性，此处设置第一列不排序
			{
				"targets": -1,
				"class":"but_xq",
				"data":null,
				"bSortable":false,
				"defaultContent":"<a id=\"edit\" href=\"#\" class=\"layui-btn layui-btn-mini\"><i class=\"layui-icon\">&#xe642;</i></a><a id=\"del\"  href=\"#\" class=\"layui-btn layui-btn-danger layui-btn-mini\"><i class=\"layui-icon\">&#xe640;</i></a>"
		}],
		"columnDefs":[{
				"visible": false,
				"targets": -1
		}],
		"text-align":"center",
		"iDisplayLength":100,
		"vertical-align":"middle",
		"ordering":true,
		"bProcessing":true,
		"bPaginate":false,
		"oLanguage":{
			"sProcessing":"正在加载中......",
			"sLengthMenu":"每页显示 _MENU_ 条记录",
			"sZeroRecords":"对不起，查询不到相关数据！",
			"sEmptyTable":"表中无数据存在！",
			"sInfo":"当前显示 _START_ 到 _END_ 条，共 _TOTAL_ 条记录",
			"sInfoFiltered":"数据表中共为 _MAX_ 条记录",
			"sSearch":"搜索",
			"oPaginate":{
				"sFirst":"首页",
				"sPrevious":"上一页",
				"sNext":"下一页",
				"sLast":"末页"
			}
		}
	});
	//修改
	$('#lens-table tbody').on( 'click', 'a#edit', function () {
		var data = $('#lens-table').DataTable().row($(this).parents('tr')).data();
		var url = SCOPE.edit_url + '&id=' + data[0];
		window.location.href=url;
	});
	//删除
	$('#lens-table tbody').on( 'click', 'a#del', function () {
		var data = $('#lens-table').DataTable().row($(this).parents('tr')).data();
		$.post("/admin.php?c=admin&a=del", {admin_id:data[0],status:0},function(result){
			if(result.status == 1){
				layer.msg(result.message, {icon: 2,time: 3000});
				<!-- self.location.reload(); -->
			}else if(result.status == 0){
				layer.msg(result.message, {icon: 1,time: 3000});
				self.location.reload();
			}
		},"JSON");
	});
});
</script>
<include file="Index/footer" />